<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Page</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark navbar-custom" style="z-index: 2;">
    <h4 style="font-weight: bold;">Sleak.com</h4>
    <div class="avathar ml-auto d-block  " id="navbarSupportedContent">
      <ul class="navbar-nav">
        <li class="nav-item d-flex ">
          <a class="nav-link text-dark p-3 " id="displayUsername" style="font-size: border ;"></a>
          <img src="" height="45px" alt="Avatar">
        </li>
        <li class="nav-item">
        </li>
      </ul>
    </div>
  </nav>
  <div class="container mt-5">
    <!-- <h2 class="mt-5 p-4">Admin panel<svg style="padding-bottom: 10px;" xmlns="http://www.w3.org/2000/svg" width="40"
        height="40" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
        <path
          d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664z" />
      </svg></h2> -->
    <div class="row">
      <!-- Add Product Section -->
      <div class="col-md-4">
        <h2>Add Product <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
            class="bi bi-database-add" viewBox="0 0 16 16">
            <path
              d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0" />
            <path
              d="M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777M3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4" />
          </svg></h2>
        <form id="addProductForm">
          <div class="form-group">
            <label for="productName">Product Name:</label>
            <input type="text" class="form-control" id="productName" required>
          </div>
          <div class="form-group">
            <label for="productPrice">Product Price:</label>
            <input type="number" class="form-control" id="productPrice" required>
          </div>
          <div class="form-group">
            <label for="productDescription">Product Description:</label>
            <textarea class="form-control" id="productDescription" required></textarea>
          </div>
          <button type="button" class="btn btn-primary" onclick="addProduct()">Add Product</button>
        </form>
      </div>
      <div class="col-md-4 predata">
        <h2>View Table Data<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
            class="bi bi-database" viewBox="0 0 16 16">
            <path
              d="M4.318 2.687C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4c0-.374.356-.875 1.318-1.313ZM13 5.698V7c0 .374-.356.875-1.318 1.313C10.766 8.729 9.464 9 8 9s-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777A4.92 4.92 0 0 0 13 5.698M14 4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16s3.022-.289 4.096-.777C13.125 14.755 14 14.007 14 13zm-1 4.698V10c0 .374-.356.875-1.318 1.313C10.766 11.729 9.464 12 8 12s-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10s3.022-.289 4.096-.777A4.92 4.92 0 0 0 13 8.698m0 3V13c0 .374-.356.875-1.318 1.313C10.766 14.729 9.464 15 8 15s-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13s3.022-.289 4.096-.777c.324-.147.633-.323.904-.525" />
          </svg></h2>
        <ul id="previousDataList" class="list-group"></ul>
      </div>
      <div class="col-md-4">
        <h2>Remove/Edit Data</h2>
        <ul id="removeEditDataList" class="list-group"></ul>
      </div>
    </div>
  </div>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyD6t43IcssnKyetqyFzyJ8zjhGNvYS2FOs",
      authDomain: "form-submit-a4117.firebaseapp.com",
      databaseURL: "https://form-submit-a4117-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "form-submit-a4117",
      storageBucket: "form-submit-a4117.appspot.com",
      messagingSenderId: "423284421117",
      appId: "1:423284421117:web:ec360f39ed01d81b8b2994",
      measurementId: "G-LL7F5C3WPW"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    // Get the query string from the URL
    const queryString = window.location.search;
    // Parse the query string to get the parameters
    const urlParams = new URLSearchParams(queryString);
    // Get the value of the 'data' parameter
    const data = urlParams.get('data');
    const gender = urlParams.get('Gender')
    // console.log(gender);
    const imgElement = document.querySelector('img');
    // Set the src attribute of the img element
    imgElement.src = `https://avatar.iran.liara.run/public/${gender}`;
    // Set the alt attribute of the img element
    imgElement.alt = 'ava';
    $('#displayUsername').text(data)
    function addProduct() {
      const productName = document.getElementById('productName').value;
      const productPrice = document.getElementById('productPrice').value;
      const productDescription = document.getElementById('productDescription').value;
      if (productName && productPrice && productDescription) {
        // Add the product to the database
        const newProductRef = database.ref(`${data}`).push();
        newProductRef.set({
          name: productName,
          price: productPrice,
          description: productDescription,
        });
        // Clear the form fields
        document.getElementById('productName').value = '';
        document.getElementById('productPrice').value = '';
        document.getElementById('productDescription').value = '';
      }
    }
    document.querySelector('.btn').addEventListener('click', function () {
      if (productName == "" || productPrice == "" || productDescription == "") {
        alert('Please enter ')
      }
      else {
        return false;
      }
    })
    // Function to display  pre data
    database.ref(`${data}`).on('value', (snapshot) => {
      const previousDataList = document.getElementById('previousDataList');
      const removeEditDataList = document.getElementById('removeEditDataList');
      // remove/edit
      previousDataList.innerHTML = '';
      removeEditDataList.innerHTML = '';
      snapshot.forEach((childSnapshot) => {
        const key = childSnapshot.key;
        const product = childSnapshot.val();
        // Display previous data
        const previousDataItem = document.createElement('li');
        previousDataItem.className = 'list-group-item';
        previousDataItem.textContent = `${product.name} - $${product.price}`;
        previousDataList.appendChild(previousDataItem);
        //  remove/edit o
        const removeEditDataItem = document.createElement('li');
        removeEditDataItem.className = 'list-group-item';
        removeEditDataItem.innerHTML = `
          <div>Name:   ${product.name} <br> Price:   $${product.price}<br> Description:   ${product.description}</div>
          <div>
            <button class="btn btn-danger" onclick="removeProduct('${key}')">Remove</button>
            <button class="btn btn-warning" onclick="editProduct('${key}', '${product.name}', '${product.price}', '${product.description}')">Edit</button>
          </div>
        `;
        removeEditDataList.appendChild(removeEditDataItem);
      });
    });
    // Function to remove a product
    function removeProduct(key) {
      database.ref(`${data}`).child(key).remove();
    }
    // Function to edit a product
    function editProduct(key, name, price, description) {
      const newName = prompt('Enter new name:', name);
      const newPrice = prompt('Enter new price:', price);
      if (newName !== null && newPrice !== null) {
        // Update the product in the database
        database.ref(`${data}`).child(key).update({
          name: newName,
          price: newPrice
        });
      }
    }
  </script>
</body>
</html>